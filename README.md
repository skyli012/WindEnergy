# 🌬️ 基于多源数据融合的 LSTM 风速预测与风场选址—储能一体化协同优化研究

## 项目概述

本项目是一个综合性风电工程决策支持系统，旨在集多源气象融合、智能预测与风场选址优化于一体，为山地风电项目规划提供科学依据。

## 核心研究内容

### 1️⃣ 人工智能风速预测模型

#### 数据融合与预处理
- **多源数据整合**：测风塔观测、再分析资料（ERA5、MERRA-2）、DEM高程与地形因子
- **异常值检测**：Isolation Forest + IQR 方法
- **缺失值处理**：KNN插补 + 线性/样条插值
- **时间同步**：统一采样间隔至10min-60min
- **数据标准化**：Z-score 和 Min-Max 标准化

#### 特征工程
- **时间序列特征**：滞后特征（lag 1/3/6/12/24）、滑动窗口统计量
- **气象特征**：温度-湿度交互、风向周期编码、气象梯度
- **地形特征**：坡度、海拔、粗糙度、风廊道指标
- **稳定性特征**：风速变异系数(CV)、加速度、突变指标

#### 预测模型对比
| 模型 | 类型 | 优势 |
|------|------|------|
| **XGBoost** | 机器学习 | 非线性拟合、特征交互强 |
| **CatBoost** | 机器学习 | 类别特征自动处理、抗过拟合 |
| **随机森林** | 机器学习 | 鲁棒性强、可解释性好 |
| **LSTM** | 深度学习 | 捕捉长期依赖、时序建模优秀 |
| **GRU** | 深度学习 | 计算效率高、序列学习强 |

#### 模型评估指标
- **RMSE**（均方根误差）
- **MAE**（平均绝对误差）
- **R²**（决定系数）
- **MAPE**（平均绝对百分比误差）
- **k-fold 交叉验证**（k=5）

---

### 2️⃣ 风场选址与储能调度优化

#### 多约束筛选框架

**硬性约束（一票否决）：**
- 🏘️ **地理空间约束**：
  - 居民区缓冲 ≥ 500m
  - 文化遗产缓冲 ≥ 500m
  - 道路缓冲 ≥ 300m

- 🌊 **风能资源约束**：
  - 年平均风速 ≥ 5 m/s（80-100m高度）
  - 年平均风能密度 ≥ 200 W/m²

- ⛰️ **地形条件约束**：
  - 坡度 ≤ 15°
  - 避免地质灾害风险区

- 🛣️ **工程可达性约束**：
  - 距离161kV输电线路 ≤ 10km
  - 距离主要道路 ≤ 5km

**优选条件：**
- ⚡ **稳定性指标**：风速变异系数 CV ≤ 0.25

#### 优化目标
- 🎯 风电出力最大化
- 📊 功率波动最小化
- 💰 综合经济效益优化

#### 优化算法
- **遗传算法（GA）**：全局搜索、种群多样性
- **粒子群优化（PSO）**：收敛速度快、参数少
- **模拟退火（SA）**：跳出局部最优

---

### 3️⃣ 储能调度策略

#### 核心功能
1. **出力平滑策略**：减少风机短时波动，采用滑动窗口优化
2. **日内优化策略**：24小时周期，最大化风电消纳，约束SOC范围和充放电功率
3. **实时调度策略**：1-10分钟采样间隔，滚动优化

#### 输出指标
- 可消纳电量（MWh）
- 弃风率（%）
- 储能SOC曲线
- 平滑后的有效出力序列

---

## 技术栈

### 数据处理
- `pandas` / `numpy`：数据操作与计算
- `scikit-learn`：特征缩放、预处理、评估指标
- `scipy`：插值与科学计算

### 机器学习与深度学习
- `xgboost`：梯度提升树
- `catboost`：分类提升树
- `tensorflow/keras`：LSTM/GRU序列模型

### 优化算法
- `scipy.optimize`：约束优化
- `deap`：遗传算法框架
- 自定义PSO/SA实现

### 可视化与Web应用
- `streamlit`：Web应用框架
- `plotly`：交互式图表
- `folium`：地理信息可视化

---

## 项目结构

```
WindEnergy/
├── main.py                          # Streamlit 主应用入口
├── data/
│   ├── raw/                         # 原始气象数据
│   ├── processed/                   # 处理后的数据
│   └── spatial/                     # 地理空间数据
├── src/
│   ├── prediction/
│   │   ├── ai_prediction.py        # 风速预测UI页面
│   │   └── wind_speed_models.py    # 预测模型实现
│   ├── optimization/
│   │   ├── opt_algorithm.py        # 优化算法核心
│   │   ├── strategy_optimization.py # 储能调度策略
│   │   └── algorithm_convergence_curve.py # 收敛性分析
│   ├── utils/
│   │   ├── data_preprocessing.py   # 数据预处理与特征工程
│   │   ├── data_import.py          # 数据导入
│   │   ├── data_analysis.py        # 探索性数据分析
│   │   ├── check_data.py           # 数据质量检查
│   │   ├── create_map.py           # 地图可视化
│   │   └── plotting_functions.py   # 绘图函数库
│   └── visualization/
│       ├── energy_storage_display.py # 储能结果展示
│       ├── energy_storage_scheduler.py # 储能调度界面
│       └── opt_result_show.py       # 优化结果展示
└── catboost_info/                   # 模型训练日志
```

---

## 核心功能模块

### 📊 数据导入与探索
```python
# 数据导入与验证
- 支持CSV格式多源气象数据
- 时间列自动解析
- 数据质量报告与统计分析
```

### 🤖 风速预测模块
```python
# 特征工程与模型训练
from src.utils.data_preprocessing import complete_preprocessing_pipeline
from src.prediction.wind_speed_models import train_all_models

# 完整预处理管道
df_processed = complete_preprocessing_pipeline(
    df, 
    target_col='wind_speed_ms',
    freq='1H'
)

# 模型训练与对比
trainer, summary = train_all_models(df_processed)
best_model, result = trainer.get_best_model()
```

### ⚡ 风场选址优化
```python
# 多约束风场选址
# 输入：风速预测结果、地形数据、约束条件
# 输出：最优机位布局、发电量评估、经济效益分析
```

### 🔋 储能调度优化
```python
# 基于风机功率序列的储能调度
# 目标：平滑出力、最大化消纳、降低弃风
# 约束：SOC范围、充放电功率、运行安全
```

---

## 使用指南

### 1. 环境配置
```bash
pip install -r requirements.txt
```

### 2. 启动Web应用
```bash
streamlit run main.py
```

### 3. 功能操作流程
```
1. 📁 数据导入 → 上传气象数据CSV文件
2. 📊 数据分析 → 探索风速、地形等特征分布
3. 🤖 风速预测 → 选择模型、训练、评估
4. ⚡ 风场选址 → 设置约束、运行优化
5. 🔋 储能调度 → 制定充放电策略
6. 📈 结果可视化 → 查看布局图、功率曲线、经济效益
```

---

## 研究指标体系

### 预测模型指标
| 指标 | 阈值 | 说明 |
|------|------|------|
| RMSE | < 2.0 m/s | 短期预测均方根误差 |
| MAE | < 1.5 m/s | 平均绝对误差 |
| R² | > 0.85 | 决定系数 |

### 风场布局指标
| 指标 | 目标 | 说明 |
|------|------|------|
| 约束满足率 | 100% | 所有硬性约束满足 |
| 年发电量 | 最大化 | 全场总发电能力 |
| 容量因数 | > 30% | 风机利用效率 |

### 储能调度指标
| 指标 | 目标 | 说明 |
|------|------|------|
| 功率波动系数 | < 0.15 | 输出平稳性 |
| 风电消纳率 | > 95% | 弃风率控制 |
| SOC稳定性 | 平稳 | 储能安全性 |

---

## 研究意义

### 理论意义
- 探索风速预测与优化在复杂山地环境下的融合应用
- 丰富山地风电系统建模与算法设计研究体系
- 为风储联合运行提供方法学参考

### 工程应用价值
- 提升山地风电场稳定出力，降低弃风率
- 降低电网调度风险和运行成本
- 为风电投资、建设及运营提供数据支撑
- 推动山区可再生能源绿色开发

---

## 主要成果

- ✅ 多源数据融合与高精度预处理系统
- ✅ LSTM/GRU + XGBoost/CatBoost 混合预测模型
- ✅ 多约束风场选址优化框架
- ✅ 智能储能调度策略
- ✅ 交互式Web可视化系统
- ✅ 完整毕业论文与技术文档

---

## 联系与支持

- 📧 项目发起：基于多源风电数据融合的智能优化研究
- 🎓 适用场景：山地风电项目规划、微电网调度、离网风电系统
- 🔧 技术支持：Python 3.8+, TensorFlow 2.x, PyTorch 可选

---

**最后更新**: 2025年11月21日  
**项目状态**: 🚀 持续开发中

